<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professor's AVL Tree Challenge</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f7f6;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 600px;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
        }
        .prof-note {
            background-color: #e8f4f8;
            border-left: 5px solid #3498db;
            padding: 10px;
            font-style: italic;
            font-size: 0.9em;
            margin-bottom: 20px;
        }
        .progress-bar {
            width: 100%;
            background-color: #e0e0e0;
            height: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background-color: #27ae60;
            width: 0%;
            transition: width 0.3s ease;
        }
        .question-box {
            display: none;
        }
        .question-box.active {
            display: block;
        }
        .question-text {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 15px;
        }
        .options {
            list-style: none;
            padding: 0;
        }
        .options li {
            margin-bottom: 10px;
        }
        .option-btn {
            width: 100%;
            padding: 12px;
            text-align: left;
            background-color: white;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1em;
        }
        .option-btn:hover {
            background-color: #ecf0f1;
            border-color: #3498db;
        }
        .option-btn.selected {
            background-color: #3498db;
            color: white;
            border-color: #3498db;
        }
        .option-btn.correct {
            background-color: #27ae60;
            color: white;
            border-color: #27ae60;
        }
        .option-btn.incorrect {
            background-color: #e74c3c;
            color: white;
            border-color: #e74c3c;
        }
        .feedback {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            display: none;
        }
        .feedback.correct {
            background-color: #d4edda;
            color: #155724;
        }
        .feedback.incorrect {
            background-color: #f8d7da;
            color: #721c24;
        }
        .btn-next {
            display: block;
            width: 100%;
            padding: 12px;
            background-color: #2c3e50;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            margin-top: 20px;
            display: none;
        }
        .btn-next:hover {
            background-color: #1a252f;
        }
        .results {
            text-align: center;
            display: none;
        }
        .score {
            font-size: 3em;
            font-weight: bold;
            color: #2c3e50;
        }
        .citation {
            font-size: 0.8em;
            color: #666;
            margin-top: 5px;
            display: block;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>AVL Tree Exam</h1>
    <div class="prof-note">
        "I've prepared this test based strictly on the slides we covered in class (Lecture 13.2). Remember, pay close attention to the Balance Factor formula and rotation mechanics!" - Prof. Gemini
    </div>

    <div class="progress-bar">
        <div class="progress-fill" id="progressBar"></div>
    </div>

    <div id="quiz-container">
        </div>

    <button class="btn-next" id="nextBtn" onclick="nextQuestion()">Next Question</button>

    <div class="results" id="resultPage">
        <h2>Exam Complete</h2>
        <p>Your Score:</p>
        <div class="score" id="finalScore">0/0</div>
        <p id="profComment"></p>
        <button class="btn-next" style="display:block" onclick="location.reload()">Retake Exam</button>
    </div>
</div>

<script>
    // Questions based on parsed slide content
    const questions = [
        {
            q: "According to the slides, what is the primary defining property of an AVL tree regarding its height?",
            options: [
                "It is a binary search tree where all leaf nodes are at the same depth.",
                "It is a BST where the heights of left and right subtrees differ by at most one.",
                "It is a BST where the balance factor is always exactly 0.",
                "It is a tree named after Adelson, Velsky, and Landis that uses arrays."
            ],
            correct: 1,
            explanation: "In an AVL tree, the heights of the left and right subtrees of any node differ by at most one.",
            citation: "[Source 75-76]"
        },
        {
            q: "What is the specific formula used in our slides to calculate the Balance Factor (BF) of a node 'i'?",
            options: [
                "BF(i) = height(i.left) - height(i.right)",
                "BF(i) = height(i.right) - height(i.left)",
                "BF(i) = height(i.left) + height(i.right)",
                "BF(i) = |height(i.left) - height(i.right)|"
            ],
            correct: 1,
            explanation: "The slides explicitly define the formula as BF(i) = height(i.right) â€“ height(i.left).",
            citation: "[Source 83]"
        },
        {
            q: "Based on the formula <em>BF(i) = height(i.right) - height(i.left)</em>, what does a <strong>negative</strong> Balance Factor (BF < 0) indicate?",
            options: [
                "The node is Right Heavy",
                "The node is Left Heavy",
                "The node is Balanced",
                "The node is corrupt"
            ],
            correct: 1,
            explanation: "If the result is negative, the left height is larger, meaning the node is Left Heavy.",
            citation: "[Source 85]"
        },
        {
            q: "Order the steps for inserting a new value into an AVL tree:",
            options: [
                "1. Update heights, 2. Insert as BST, 3. Rebalance",
                "1. Insert as BST, 2. Update heights of ancestors, 3. Calculate BF & Rebalance if needed",
                "1. Check BF, 2. Insert as BST, 3. Rotate",
                "1. Insert as BST, 2. Rotate immediately, 3. Update heights"
            ],
            correct: 1,
            explanation: "Step 1: Insert (BST rules). Step 2: Update height of ancestors. Step 3: Check BF and rebalance.",
            citation: "[Source 90-94]"
        },
        {
            q: "When updating the height of an ancestor node after insertion, what formula is used?",
            options: [
                "new_height = 1 + min(height(left), height(right))",
                "new_height = height(left) + height(right)",
                "new_height = 1 + max(height(left), height(right))",
                "new_height = max(height(left), height(right))"
            ],
            correct: 2,
            explanation: "The height is always 1 (for the node itself) plus the maximum height of its children.",
            citation: "[Source 93]"
        },
        {
            q: "At what threshold of the Balance Factor (BF) must you trigger a rebalancing (rotation)?",
            options: [
                "If BF is not exactly 0",
                "If BF > 0 or BF < 0",
                "If BF > 1 or BF < -1",
                "If BF is positive"
            ],
            correct: 2,
            explanation: "The tree is considered balanced as long as the difference is at most 1. Rebalancing is needed if BF > 1 or BF < -1.",
            citation: "[Source 94]"
        },
        {
            q: "Scenario: You have an unbalanced node N. The imbalance was caused by an insertion into the <strong>Left child's Left subtree (LL)</strong>. What rotation fixes this?",
            options: [
                "Left Rotation",
                "Right Rotation",
                "Left-Right Rotation",
                "Right-Left Rotation"
            ],
            correct: 1,
            explanation: "An LL imbalance (insertion into Left child's Left subtree) requires a Right Rotation.",
            citation: "[Source 122, 132]"
        },
        {
            q: "Scenario: You have an unbalanced node N. The imbalance was caused by an insertion into the <strong>Right child's Right subtree (RR)</strong>. What rotation fixes this?",
            options: [
                "Left Rotation",
                "Right Rotation",
                "Left-Right Rotation",
                "Right-Left Rotation"
            ],
            correct: 0,
            explanation: "An RR imbalance (insertion into Right child's Right subtree) requires a Left Rotation.",
            citation: "[Source 152, 162]"
        },
        {
            q: "During a <strong>Right Rotation</strong> on node N (with left child L), what happens to L's right subtree (LR)?",
            options: [
                "It becomes the left child of N",
                "It becomes the right child of N",
                "It stays attached to L",
                "It is deleted"
            ],
            correct: 0,
            explanation: "In a right rotation: L.right becomes N, and N.left takes ownership of the old L.right (LR).",
            citation: "[Source 140-141]"
        },
        {
            q: "Due to the balanced property, what is the time complexity for common operations (Insert, Delete, Search) in an AVL Tree?",
            options: [
                "O(n)",
                "O(n log n)",
                "O(log n)",
                "O(1)"
            ],
            correct: 2,
            explanation: "AVL trees guarantee O(log n) complexity because they remain balanced.",
            citation: "[Source 79]"
        }
    ];

    let currentQuestion = 0;
    let score = 0;

    function loadQuestion() {
        const container = document.getElementById('quiz-container');
        container.innerHTML = '';
        const q = questions[currentQuestion];

        const qDiv = document.createElement('div');
        qDiv.className = 'question-box active';
        
        const qText = document.createElement('div');
        qText.className = 'question-text';
        qText.innerHTML = `${currentQuestion + 1}. ${q.q}`;
        qDiv.appendChild(qText);

        const optsUl = document.createElement('ul');
        optsUl.className = 'options';

        q.options.forEach((opt, index) => {
            const li = document.createElement('li');
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerHTML = opt;
            btn.onclick = () => checkAnswer(index, btn, q);
            li.appendChild(btn);
            optsUl.appendChild(li);
        });
        qDiv.appendChild(optsUl);

        const feedback = document.createElement('div');
        feedback.id = 'feedback';
        feedback.className = 'feedback';
        qDiv.appendChild(feedback);

        container.appendChild(qDiv);
        
        // Update progress bar
        const progress = ((currentQuestion) / questions.length) * 100;
        document.getElementById('progressBar').style.width = `${progress}%`;
        
        document.getElementById('nextBtn').style.display = 'none';
    }

    function checkAnswer(selectedIndex, btn, q) {
        // Disable all buttons
        const buttons = document.querySelectorAll('.option-btn');
        buttons.forEach(b => b.disabled = true);

        const feedback = document.getElementById('feedback');
        feedback.style.display = 'block';

        if (selectedIndex === q.correct) {
            btn.classList.add('correct');
            feedback.innerHTML = `<strong>Correct!</strong> ${q.explanation} <span class="citation">${q.citation}</span>`;
            feedback.classList.add('correct');
            score++;
        } else {
            btn.classList.add('incorrect');
            buttons[q.correct].classList.add('correct');
            feedback.innerHTML = `<strong>Incorrect.</strong> ${q.explanation} <span class="citation">${q.citation}</span>`;
            feedback.classList.add('incorrect');
        }

        document.getElementById('nextBtn').style.display = 'block';
    }

    function nextQuestion() {
        currentQuestion++;
        if (currentQuestion < questions.length) {
            loadQuestion();
        } else {
            showResults();
        }
    }

    function showResults() {
        document.getElementById('quiz-container').style.display = 'none';
        document.getElementById('nextBtn').style.display = 'none';
        document.getElementById('resultPage').style.display = 'block';
        document.getElementById('progressBar').style.width = '100%';
        
        document.getElementById('finalScore').innerText = `${score}/${questions.length}`;
        
        const comment = document.getElementById('profComment');
        const percentage = (score / questions.length) * 100;
        
        if (percentage === 100) {
            comment.innerText = "Outstanding! You have mastered the AVL Tree concepts perfectly.";
        } else if (percentage >= 70) {
            comment.innerText = "Good job! You understand the core concepts well, but review the specifics of rotation pointers.";
        } else {
            comment.innerText = "You might want to review the slides again, specifically the Balance Factor formula and Rebalancing steps.";
        }
    }

    // Initialize
    loadQuestion();
</script>

</body>
</html>